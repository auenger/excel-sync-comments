# Excel 批注同步工具 - 使用说明

## 📋 工具简介

这是一个 Excel 批注同步工具，可以将一个 Excel 文件中的批注同步到另一个 Excel 文件中，支持：
- ✅ 多区域筛选
- ✅ 批注智能合并
- ✅ 详细日志记录
- ✅ 配置文件支持（无需重新打包）

## 🚀 快速开始

### 1. 准备文件

将以下文件放在同一个文件夹中：
```
📁 工作目录/
  ├── 批注同步工具（可执行文件）
  ├── config.ini（配置文件）
  ├── source.xlsx（源文件，包含批注）
  └── target.xlsx（目标文件，需要添加批注）
```

### 2. 修改配置（可选）

打开 `config.ini` 文件，根据需要修改配置：

```ini
[文件路径]
源文件 = source.xlsx
目标文件 = target.xlsx
输出文件 = target_updated.xlsx

[列配置]
区域列 = C
姓名列 = B
同步列 = DO, DP, DS, DU

[筛选条件]
筛选区域 = 厦门, 福州, 泉州

[数据设置]
数据起始行 = 3

[批注合并]
启用合并 = True
分隔符 = \n---\n
```

### 3. 运行工具

- **Windows**: 双击 `批注同步工具.exe`
- **macOS/Linux**: 双击 `批注同步工具` 或在终端运行 `./批注同步工具`

### 4. 查看结果

运行完成后，会生成两个文件：
- `target_updated.xlsx` - 同步后的 Excel 文件
- `sync_log_YYYYMMDD_HHMMSS.txt` - 详细日志文件

## ⚙️ 配置说明

### 文件路径配置

| 配置项 | 说明 | 示例 |
|--------|------|------|
| 源文件 | 包含批注的源 Excel 文件名 | `source.xlsx` |
| 目标文件 | 需要添加批注的目标 Excel 文件名 | `target.xlsx` |
| 输出文件 | 同步后保存的文件名 | `target_updated.xlsx` |

### 列配置

| 配置项 | 说明 | 示例 |
|--------|------|------|
| 区域列 | 区域所在的列（Excel 列字母） | `C` |
| 姓名列 | 姓名所在的列（Excel 列字母） | `B` |
| 同步列 | 需要同步批注的列（逗号分隔） | `DO, DP, DS, DU` |

### 筛选条件

| 配置项 | 说明 | 示例 |
|--------|------|------|
| 筛选区域 | 只处理这些区域的数据（逗号分隔）<br>留空或填 `None` 表示不筛选 | `厦门, 福州, 泉州` |

### 数据设置

| 配置项 | 说明 | 示例 |
|--------|------|------|
| 数据起始行 | 数据从第几行开始（避开表头） | `3` |

### 批注合并

| 配置项 | 说明 | 示例 |
|--------|------|------|
| 启用合并 | 如果目标单元格已有批注，是否合并 | `True` 或 `False` |
| 分隔符 | 合并批注时使用的分隔符 | `\n---\n` |

## 📝 使用示例

### 示例 1：同步单个区域的批注

```ini
[筛选条件]
筛选区域 = 厦门
```

### 示例 2：同步多个区域的批注

```ini
[筛选条件]
筛选区域 = 厦门, 福州, 泉州, 龙岩
```

### 示例 3：同步所有区域（不筛选）

```ini
[筛选条件]
筛选区域 = None
```

### 示例 4：只同步特定列的批注

```ini
[列配置]
同步列 = DO, DU
```

### 示例 5：禁用批注合并（覆盖模式）

```ini
[批注合并]
启用合并 = False
```

## 📊 日志文件说明

每次运行后会生成详细的日志文件，包含：

1. **配置信息**：显示本次运行使用的所有配置
2. **统计信息**：匹配人员数、同步批注数、合并批注数等
3. **详细操作记录**：每个批注的同步操作（新增/合并/覆盖）
4. **合并批注详情**：显示被合并的批注的原内容和新内容

示例：
```
[合并] 张三 - 列DO (单元格DO100)
[新增] 李四 - 列DP (单元格DP200)
[覆盖] 王五 - 列DS (单元格DS300)
```

## 🔧 常见问题

### Q1: 如何修改配置？
**A**: 直接编辑 `config.ini` 文件，保存后重新运行工具即可，**无需重新打包**。

### Q2: 配置文件丢失了怎么办？
**A**: 工具会自动使用默认配置运行，不会报错。你可以重新创建 `config.ini` 文件。

### Q3: 如何知道哪些批注被合并了？
**A**: 查看生成的日志文件，在【合并批注详情】部分可以看到所有合并的批注。

### Q4: 批注合并是什么意思？
**A**: 如果目标单元格已经有批注，启用合并后会将新批注追加到原批注后面，用分隔符隔开。禁用合并则会直接覆盖原批注。

### Q5: 为什么找不到 Excel 文件？
**A**: 确保 Excel 文件与可执行文件在同一目录下，文件名与配置文件中的设置一致。

### Q6: macOS 提示"无法打开，因为无法验证开发者"
**A**: 右键点击可执行文件 > 选择"打开" > 点击"打开"确认。

### Q7: 如何修改文件名？
**A**: 在 `config.ini` 的【文件路径】部分修改文件名即可。

## 💡 高级技巧

### 技巧 1：批量处理多个文件

如果需要处理多组文件，可以：
1. 创建多个文件夹，每个文件夹放一组文件
2. 将可执行文件和配置文件复制到每个文件夹
3. 分别运行

### 技巧 2：保留历史日志

日志文件名包含时间戳，不会被覆盖，可以保留所有历史记录。

### 技巧 3：自定义分隔符

可以修改批注合并的分隔符，例如：
```ini
分隔符 = \n========\n
```

### 技巧 4：快速切换配置

可以准备多个配置文件（如 `config_厦门.ini`、`config_福州.ini`），使用时重命名为 `config.ini`。

## 📞 技术支持

如有问题，请查看日志文件中的错误信息，或联系开发人员。

---

**版本**: 1.0  
**更新日期**: 2026-01-07
