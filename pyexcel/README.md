# Excel 批注同步工具

一个强大的 Excel 批注同步工具，支持多区域筛选、批注智能合并和详细日志记录。

## ✨ 主要特性

- ✅ **多区域筛选**：支持同时筛选多个区域的数据
- ✅ **批注智能合并**：自动合并已有批注，不会丢失原有信息
- ✅ **配置文件支持**：通过配置文件修改参数，无需重新打包
- ✅ **详细日志记录**：自动生成详细的操作日志
- ✅ **独立可执行文件**：无需安装 Python 环境即可运行

## 📦 文件说明

| 文件 | 说明 |
|------|------|
| `sync_comments.py` | 主程序源代码 |
| `config.ini` | 配置文件 |
| `build_exe.py` | 打包脚本 |
| `create_distribution.py` | 分发包创建脚本 |
| `使用说明.md` | 用户使用说明（详细） |
| `开发者文档.md` | 开发者文档（技术细节） |
| `打包说明.md` | 打包说明 |

## 🚀 快速开始

### 对于开发者

```bash
# 1. 激活虚拟环境
source ../.venv/bin/activate

# 2. 安装依赖
pip install openpyxl

# 3. 运行脚本
python sync_comments.py

# 4. 打包成可执行文件
python build_exe.py

# 5. 创建分发包
python create_distribution.py
```

### 对于最终用户

1. 解压分发包 `批注同步工具_macOS_YYYYMMDD.zip`
2. 将 Excel 文件放入文件夹
3. 修改 `config.ini`（可选）
4. 双击运行可执行文件
5. 查看生成的结果

## ⚙️ 配置示例

```ini
[文件路径]
源文件 = source.xlsx
目标文件 = target.xlsx
输出文件 = target_updated.xlsx

[列配置]
区域列 = C
姓名列 = B
同步列 = DO, DP, DS, DU

[筛选条件]
筛选区域 = 厦门, 福州, 泉州

[数据设置]
数据起始行 = 3

[批注合并]
启用合并 = True
分隔符 = \n---\n
```

## 📊 使用流程

```
源文件 (source.xlsx)
    ↓
  读取批注
    ↓
  根据姓名匹配
    ↓
目标文件 (target.xlsx)
    ↓
  同步/合并批注
    ↓
输出文件 (target_updated.xlsx)
    +
详细日志 (sync_log_*.txt)
```

## 🔧 核心功能

### 1. 多区域筛选

支持同时处理多个区域的数据：
```ini
筛选区域 = 厦门, 福州, 泉州, 龙岩
```

### 2. 批注智能合并

当目标单元格已有批注时：
- **启用合并**：保留原批注，追加新批注
- **禁用合并**：直接覆盖原批注

### 3. 详细日志

自动生成包含以下信息的日志：
- 配置信息
- 统计信息（匹配人数、同步数量等）
- 详细操作记录（每个批注的操作）
- 合并批注详情（原内容和新内容）

## 📝 输出示例

运行后生成：
1. `target_updated.xlsx` - 同步后的 Excel 文件
2. `sync_log_20260107_091334.txt` - 详细日志文件

日志示例：
```
[合并] 张三 - 列DO (单元格DO100)
[新增] 李四 - 列DP (单元格DP200)
[覆盖] 王五 - 列DS (单元格DS300)
```

## 🎯 适用场景

- HR 数据批注同步
- 多区域数据批注管理
- 批注内容合并和追踪
- 批量批注处理

## 💡 优势

1. **无需重新打包**：修改配置文件即可调整参数
2. **智能合并**：不会丢失已有批注信息
3. **详细追踪**：完整记录每个操作
4. **易于分发**：打包成独立可执行文件

## 📚 文档

- [使用说明.md](./使用说明.md) - 用户使用指南
- [开发者文档.md](./开发者文档.md) - 技术文档
- [打包说明.md](./打包说明.md) - 打包指南

## 🔄 版本

**当前版本**: v1.0  
**发布日期**: 2026-01-07  
**Python 版本**: 3.9+

## 📞 支持

如有问题，请查看：
1. 使用说明.md 中的常见问题
2. 生成的日志文件中的错误信息
3. 联系开发者

---

**开发者**: Ryan  
**项目路径**: `/Users/ryan/mycode/HRExcel/pyexcel/`
