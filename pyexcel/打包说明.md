# 批注同步工具 - 使用说明

## 📦 打包成可执行文件

### 方法一：使用自动打包脚本（推荐）

1. **运行打包脚本**
   ```bash
   cd /Users/ryan/mycode/HRExcel/pyexcel
   source ../.venv/bin/activate
   python build_exe.py
   ```

2. **打包完成后**
   - 可执行文件位于 `dist/批注同步工具` 或 `dist/批注同步工具.exe`（Windows）
   - 将可执行文件复制到任意位置即可使用

### 方法二：手动打包

1. **安装 PyInstaller**
   ```bash
   pip install pyinstaller
   ```

2. **执行打包命令**
   ```bash
   cd /Users/ryan/mycode/HRExcel/pyexcel
   pyinstaller --onefile --name=批注同步工具 --clean sync_comments.py
   ```

3. **查看结果**
   - 可执行文件在 `dist` 文件夹中

## 🚀 使用打包后的可执行文件

### 文件准备
将以下文件放在同一个文件夹中：
```
📁 工作目录/
  ├── 批注同步工具（或 批注同步工具.exe）
  ├── source.xlsx
  └── target.xlsx
```

### 运行方式
- **macOS/Linux**: 双击 `批注同步工具` 或在终端运行 `./批注同步工具`
- **Windows**: 双击 `批注同步工具.exe`

### 运行后生成的文件
```
📁 工作目录/
  ├── 批注同步工具
  ├── source.xlsx
  ├── target.xlsx
  ├── target_updated.xlsx  ← 同步后的文件
  └── sync_log_YYYYMMDD_HHMMSS.txt  ← 详细日志
```

## ⚙️ 配置修改

如果需要修改配置（如区域、列等），需要：
1. 编辑 `sync_comments.py` 源文件
2. 重新打包

或者，可以创建配置文件版本（见下方高级用法）

## 🔧 高级：支持配置文件

如果希望用户可以通过配置文件修改参数而不需要重新打包，可以：
1. 创建 `config.ini` 配置文件
2. 修改脚本读取配置文件
3. 用户只需修改配置文件即可

## 📝 注意事项

1. **文件路径**: 可执行文件会在当前工作目录查找 `source.xlsx` 和 `target.xlsx`
2. **权限问题**: macOS 首次运行可能需要在"系统偏好设置 > 安全性与隐私"中允许
3. **文件大小**: 打包后的文件约 10-20MB（包含 Python 运行时）
4. **跨平台**: 
   - macOS 打包的文件只能在 macOS 运行
   - Windows 打包的文件只能在 Windows 运行
   - 需要在目标平台上分别打包

## 🎯 分发给其他人

### 简单分发（推荐）
将以下文件打包成 zip：
```
批注同步工具.zip
  ├── 批注同步工具（可执行文件）
  ├── 使用说明.txt
  └── 示例文件/
      ├── source.xlsx（示例）
      └── target.xlsx（示例）
```

### 完整分发
如果需要跨平台支持，准备：
- `批注同步工具_macOS.zip`
- `批注同步工具_Windows.zip`
- `批注同步工具_Linux.zip`

## 🐛 常见问题

**Q: macOS 提示"无法打开，因为无法验证开发者"**
A: 右键点击文件 > 选择"打开" > 点击"打开"确认

**Q: 运行时找不到 Excel 文件**
A: 确保 source.xlsx 和 target.xlsx 与可执行文件在同一目录

**Q: 打包后文件太大**
A: 这是正常的，因为包含了完整的 Python 运行时和所有依赖库

**Q: 想要修改配置怎么办**
A: 需要修改源代码后重新打包，或使用配置文件版本
